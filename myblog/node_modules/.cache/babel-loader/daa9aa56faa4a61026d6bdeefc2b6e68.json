{"ast":null,"code":"var _jsxFileName = \"/home/zadmin/Desktop/blog-react/myblog/src/components/molecules/GetPosts.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Logincms, Blog, DeletePost, Commentlist, Comment } from '../../cms_pb';\nimport { CmsBlogClient, Metadata } from '../../cms_grpc_web_pb';\nimport BlogTitle from '../atoms/blog-TitleTextArea';\nimport BlogContent from \"../atoms/blog-ContentTextArea\";\nimport HeaderTag from '../atoms/HeaderTag';\nimport '../molecules/css/Molecules.css';\nimport Search from './Search';\nimport CommentTag from './blog-Comment';\nimport AboutMe from './AboutMe';\n\nclass GetPosts extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentUser: authenticationService.currentUserValue,\n      users: null,\n      blogs: [],\n      newdata: [],\n      searchTerm: '',\n      commentBlogId: 123,\n      blogCreated: false\n    };\n    this.title = React.createRef();\n    this.content = React.createRef();\n    this.commentBlogId = React.createRef();\n    this.handleOnSubmit = this.handleOnSubmit.bind(this);\n    this.handleOnComment = this.handleOnComment.bind(this);\n    this.onSearchChange = this.onSearchChange.bind(this);\n    this.onDismiss = this.onDismiss.bind(this);\n  }\n\n  componentDidMount() {\n    //userService.getAll().then(users => this.setState({ users }));\n    const {\n      searchTerm\n    } = this.state;\n    var client = new CmsBlogClient('http://localhost:51053');\n    var request = new Logincms();\n    request.setResponsecode(420);\n    request.setResponsemessage(\"Hello\");\n    var header = new Headers();\n    var token = \"Bearer \" + this.state.currentUser.token;\n    console.log(token);\n    client.post(request, {\n      \"Authorization\": token\n    }, (err, response) => {\n      const outerArray = response;\n      {\n        outerArray[\"array\"][1].map(dataitem => {\n          var updateddata = this.state.blogs.concat({\n            blogid: dataitem[0],\n            title: dataitem[4],\n            content: dataitem[1],\n            creationdate: dataitem[5],\n            refuser: dataitem[2],\n            comments: dataitem[3]\n          });\n          this.setState({\n            blogs: updateddata\n          });\n        });\n      }\n    });\n  }\n\n  onDismiss(id) {\n    const isNotId = blog => blog.blogid !== id;\n\n    const updatedList = this.state.blogs.filter(isNotId);\n    this.setState({\n      blogs: updatedList\n    });\n  }\n\n  onSearchChange(event) {\n    this.setState({\n      searchTerm: event.target.value\n    });\n  }\n\n  handleOnSubmit(event) {\n    event.preventDefault();\n    var client = new CmsBlogClient('http://localhost:51053');\n    var request = new Blog();\n    request.setBlogid(123);\n    request.setTitle(this.title.current.value);\n    request.setContent(this.content.current.value);\n    request.setRefuser(this.state.currentUser.username);\n    let commentList = new Commentlist();\n    request.setComments(commentList);\n    request.setCreationdate(\"2020-03-06\"); // for setting token\n\n    var token = \"Bearer \" + this.state.currentUser.token;\n    console.log(token); //let updatedData = [];\n\n    client.create(request, {\n      \"Authorization\": token\n    }, (err, response) => {\n      console.log(response);\n    });\n\n    if (!alert('New blog post has been saved!')) {\n      window.location.reload();\n    }\n  }\n\n  handleOnComment(event) {\n    if (event.keyCode == 13 && event.shiftKey == false) {\n      const userCommentContent = event.target.value.trim();\n      const blogid = event.target.id;\n      event.preventDefault();\n      let userComment = new Comment();\n      userComment.setCommentsid(123);\n      userComment.setContent(userCommentContent);\n      userComment.setCommentsdate(Date.now());\n      userComment.setBlogid(blogid);\n      userComment.setRefuser(this.state.currentUser.username);\n      var client = new CmsBlogClient('http://localhost:51053'); // for setting token\n\n      var token = \"Bearer \" + this.state.currentUser.token;\n      console.log(token); //let updatedData = [];\n\n      client.postcomment(userComment, {\n        \"Authorization\": token\n      }, (err, response) => {\n        console.log(response);\n      }); //if(!alert('Comments saved!')){window.location.reload();}\n\n      this.setState({\n        blogCreated: true\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"page\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleOnSubmit,\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      ref: this.title,\n      placeholder: \"Blog Title\",\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 97\n      }\n    }), /*#__PURE__*/React.createElement(\"textarea\", {\n      ref: this.content,\n      placeholder: \"Blog description\",\n      rows: \"5\",\n      cols: \"40\",\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"button2\",\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 25\n      }\n    }, \"Submit\"))), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 24\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"interactions\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Search, {\n      value: searchTerm,\n      onChange: this.onSearchChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"leftcolumn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 21\n      }\n    }, blogs.filter(isSearched(searchTerm)).map(blog => /*#__PURE__*/React.createElement(\"div\", {\n      key: blog.blogid,\n      className: \"card\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(BlogTitle, {\n      blogid: blog.blogid,\n      title: blog.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 41\n      }\n    }), /*#__PURE__*/React.createElement(HeaderTag, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 41\n      }\n    }, blog.creationdate, \", \", blog.refuser), /*#__PURE__*/React.createElement(BlogContent, {\n      blogid: blog.blogid,\n      content: blog.content,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 41\n      }\n    }), /*#__PURE__*/React.createElement(CommentTag, {\n      blog: blog,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 41\n      }\n    })))), /*#__PURE__*/React.createElement(AboutMe, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 21\n      }\n    })));\n  }\n\n}\n\nfunction isSearched(searchTerm) {\n  return function (blog) {\n    return !searchTerm || blog.title.toLowerCase().includes(searchTerm.toLowerCase());\n  };\n}\n\nexport default GetPosts;","map":{"version":3,"sources":["/home/zadmin/Desktop/blog-react/myblog/src/components/molecules/GetPosts.jsx"],"names":["React","useState","useEffect","Logincms","Blog","DeletePost","Commentlist","Comment","CmsBlogClient","Metadata","BlogTitle","BlogContent","HeaderTag","Search","CommentTag","AboutMe","GetPosts","Component","constructor","props","state","currentUser","authenticationService","currentUserValue","users","blogs","newdata","searchTerm","commentBlogId","blogCreated","title","createRef","content","handleOnSubmit","bind","handleOnComment","onSearchChange","onDismiss","componentDidMount","client","request","setResponsecode","setResponsemessage","header","Headers","token","console","log","post","err","response","outerArray","map","dataitem","updateddata","concat","blogid","creationdate","refuser","comments","setState","id","isNotId","blog","updatedList","filter","event","target","value","preventDefault","setBlogid","setTitle","current","setContent","setRefuser","username","commentList","setComments","setCreationdate","create","alert","window","location","reload","keyCode","shiftKey","userCommentContent","trim","userComment","setCommentsid","setCommentsdate","Date","now","postcomment","render","isSearched","toLowerCase","includes"],"mappings":"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","sourcesContent":["import React,{ useState, useEffect } from 'react';\n\nimport { Logincms, Blog, DeletePost, Commentlist, Comment } from '../../cms_pb';\nimport { CmsBlogClient, Metadata } from '../../cms_grpc_web_pb'\n\nimport BlogTitle from '../atoms/blog-TitleTextArea';\nimport BlogContent from \"../atoms/blog-ContentTextArea\";\nimport HeaderTag from '../atoms/HeaderTag';\n\nimport '../molecules/css/Molecules.css'\nimport Search from './Search'\nimport CommentTag from './blog-Comment';\nimport AboutMe from './AboutMe';\n\nclass GetPosts extends React.Component{\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            currentUser: authenticationService.currentUserValue,\n            users: null,\n            blogs: [],\n            newdata: [],\n            searchTerm: '',\n            commentBlogId: 123,\n            blogCreated: false,\n        };\n        this.title = React.createRef();\n        this.content = React.createRef();\n        this.commentBlogId = React.createRef();\n        this.handleOnSubmit = this.handleOnSubmit.bind(this);\n        this.handleOnComment = this.handleOnComment.bind(this);\n        this.onSearchChange = this.onSearchChange.bind(this);\n        this.onDismiss = this.onDismiss.bind(this);\n    }\n\n    componentDidMount() {\n        //userService.getAll().then(users => this.setState({ users }));\n\n        const { searchTerm } = this.state;\n        var client = new CmsBlogClient('http://localhost:51053');\n        var request = new Logincms();\n\n        request.setResponsecode(420);\n        request.setResponsemessage(\"Hello\");\n        var header = new Headers();\n        var token = \"Bearer \"+this.state.currentUser.token;\n        console.log(token);\n\n\n        client.post(request, {\"Authorization\": token}, (err, response) => {\n            const outerArray = response;\n            {outerArray[\"array\"][1].map((dataitem) => {\n\n                var updateddata = this.state.blogs.concat({\n                    blogid: dataitem[0],\n                    title: dataitem[4],\n                    content: dataitem[1],\n                    creationdate: dataitem[5],\n                    refuser: dataitem[2],\n                    comments: dataitem[3]\n                });\n                this.setState({blogs: updateddata})\n\n            })}\n        });\n    }\n\n    onDismiss(id){\n        const isNotId = blog => blog.blogid !== id;\n        const updatedList = this.state.blogs.filter(isNotId);\n        this.setState({blogs: updatedList});\n    }\n\n    onSearchChange(event){\n        this.setState({ searchTerm: event.target.value })\n    }\n\n    handleOnSubmit(event){\n        event.preventDefault();\n\n        var client = new CmsBlogClient('http://localhost:51053');\n\n        var request = new Blog();\n\n        request.setBlogid(123);\n        request.setTitle(this.title.current.value);\n        request.setContent(this.content.current.value);\n        request.setRefuser(this.state.currentUser.username);\n        let commentList = new Commentlist();\n        request.setComments(commentList);\n        request.setCreationdate(\"2020-03-06\");\n\n        // for setting token\n        var token = \"Bearer \"+this.state.currentUser.token;\n        console.log(token);\n\n\n        //let updatedData = [];\n        client.create(request, {\"Authorization\": token}, (err, response) => {\n            console.log(response);\n        });\n        if(!alert('New blog post has been saved!')){window.location.reload();}\n\n    }\n\n\n    handleOnComment(event){\n\n        if (event.keyCode == 13 && event.shiftKey == false){\n            const userCommentContent = event.target.value.trim();\n            const blogid = event.target.id;\n\n            event.preventDefault();\n\n            let userComment = new Comment();\n            userComment.setCommentsid(123);\n            userComment.setContent(userCommentContent);\n            userComment.setCommentsdate(Date.now());\n            userComment.setBlogid(blogid);\n            userComment.setRefuser(this.state.currentUser.username);\n\n            var client = new CmsBlogClient('http://localhost:51053');\n            // for setting token\n            var token = \"Bearer \"+this.state.currentUser.token;\n            console.log(token);\n\n\n            //let updatedData = [];\n            client.postcomment(userComment, {\"Authorization\": token}, (err, response) => {\n                console.log(response);\n            });\n            //if(!alert('Comments saved!')){window.location.reload();}\n            this.setState({blogCreated: true})\n        }\n\n    }\n\n    render(){\n        return(\n            <div className=\"page\">\n                <form onSubmit={this.handleOnSubmit} className=\"row\">\n                    <div className=\"row\">\n                        <input type=\"text\" ref={this.title} placeholder=\"Blog Title\"  required/><br/>\n                        <textarea ref={this.content} placeholder=\"Blog description\" rows=\"5\" cols=\"40\" required/>\n                        <button className=\"button2\" type=\"submit\" >Submit</button>\n                    </div>\n                </form><br/>\n                <div className=\"interactions\">\n                    <Search\n                        value = {searchTerm}\n                        onChange = {this.onSearchChange}\n                    >\n                    </Search>\n                </div>\n                <div className=\"row\">\n                    <div className=\"leftcolumn\">\n                        {\n                            blogs.filter(isSearched(searchTerm)).map(blog =>\n                                    <div key={blog.blogid} className=\"card\">\n                                        <BlogTitle blogid={blog.blogid} title={blog.title}/>\n                                        <HeaderTag>{blog.creationdate}, {blog.refuser}</HeaderTag>\n                                        <BlogContent blogid={blog.blogid} content={blog.content} />\n                                        <CommentTag blog={blog} />\n                                    </div>\n                            )\n                        }\n                    </div>\n                    <AboutMe />\n                </div>\n            </div>\n        );\n    }\n}\n\nfunction isSearched(searchTerm) {\n    return function (blog) {\n        return !searchTerm || blog.title.toLowerCase().includes(searchTerm.toLowerCase());\n    }\n}\n\nexport default GetPosts;"]},"metadata":{},"sourceType":"module"}